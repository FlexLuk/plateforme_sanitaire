@page "/ordonnance_docteurr/{idFichiste}"
@using LYRA.Controllers.ComtrollerMedecin
@using LYRA.Controllers.ControllerFichiste
@using LYRA.Controllers.ControllerOrdonnance
@using LYRA.Controllers.ControllerParametre
@using LYRA.Controllers.ControllerSecretaire
@using LYRA.Controllers.ControllerUtilisateur
@using LYRA.Controllers.PharmacieController
@using LYRA.Controllers.SoinsController
@using LYRA.Models
@using LYRA.Models.Pharmacie
@using LYRA.Shared.Medecin
@inject IPharmacieService pharmacieService
@using Blazored.Toast
@using Blazored.Toast.Configuration
@using Blazored.Toast.Services
@inject Blazored.Toast.Services.IToastService toastService
@inject NavigationManager Go
@inject IAffiliationService affiliService
@inject IAdhesionService adhesionService
@inject IFichisteService fichisteservice
@inject ISoinsService soinsService
@inject IParametreService parametreService
@inject IMedecinService medecinService
@inject IOrdonnanceService ordonnanceService
@inject ILocalStorageService _localStorageService
@inject IUtilisateurService uService
@layout MedecinLayout
@inject Blazored.SessionStorage.ISessionStorageService sessionStorage
@attribute [Authorize(Roles = "Admin, Medecin")]
<style>

     {mso-displayed-decimal-separator:"\.";
     mso-displayed-thousand-separator:"\,";}
    @@page
     {
     mso-header-data:"";
     mso-footer-data:"";
     margin:0.3in 0.24in 0.75in 0.35in;
     mso-header-margin:0.3in;
     mso-footer-margin:0.3in;
     mso-page-orientation:Portrait;
     }
    tr
     {mso-height-source:auto;
     mso-ruby-visibility:none;}
    col
     {mso-width-source:auto;
     mso-ruby-visibility:none;}
    br
     {mso-data-placement:same-cell;}
    ruby
     {ruby-align:left;}
    .style0
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     mso-style-name:Normal;
     mso-style-id:0;}
    .font8
     {
     color:#000000;
     font-size:7pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif; }
    td
     {mso-style-parent:style0;
     mso-number-format:General;
     text-align:general;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     mso-ignore:padding;}
    .x15
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x22
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x23
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:12pt;
     font-weight:400;
     font-style:normal;
     font-family:Algerian,sans-serif;
     mso-protection:locked visible;
     }
    .x24
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid #000000;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:2px solid #000000;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x25
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid #000000;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:none;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x26
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid #000000;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:none;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x27
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:none;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:2px solid #000000;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x28
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:none;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:none;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x29
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid #000000;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:2px solid #000000;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x30
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:none;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:2px solid #000000;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x31
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:7pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x32
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#0563C1;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     text-decoration:underline;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x33
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:7pt;
     font-weight:400;
     font-style:normal;
     text-decoration:underline;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x34
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x35
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x36
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x37
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x38
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:2px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x39
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x40
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:2px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x41
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x42
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x43
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:8pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid #000000;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:none;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x44
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:#9DC3E6;
     mso-pattern:auto none;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x45
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x46
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:16pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x47
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:16pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x48
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x49
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x50
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:16pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:2px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x51
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:2px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x52
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:2px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x53
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:400;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:1px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:2px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x54
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:normal;word-wrap:break-word;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:9pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid #000000;
     border-right:2px solid #000000;
     border-bottom:2px solid #000000;
     border-left:2px solid #000000;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x55
     {
     mso-number-format:General;
     text-align:general;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#9DC3E6;
     font-size:11pt;
     font-weight:400;
     font-style:italic;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x56
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:none;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x57
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:none;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x58
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:20pt;
     font-weight:400;
     font-style:normal;
     font-family:Algerian,sans-serif;
     mso-protection:locked visible;
     }
    .x59
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:12pt;
     font-weight:700;
     font-style:italic;
     text-decoration:underline; mso-text-underline:double;
     font-family:'Agency FB',sans-serif;
     border-top:none;
     border-right:none;
     border-bottom:2px solid #000000;
     border-left:none;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x60
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     text-decoration:underline;
     font-family:'Baskerville Old Face',serif;
     mso-protection:locked visible;
     }
    .x61
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:12pt;
     font-weight:700;
     font-style:italic;
     text-decoration:underline; mso-text-underline:double;
     font-family:'Agency FB',sans-serif;
     mso-protection:locked visible;
     }
    .x62
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:2px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x63
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid windowtext;
     border-right:1px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x64
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:bottom;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     border-top:2px solid windowtext;
     border-right:2px solid windowtext;
     border-bottom:1px solid windowtext;
     border-left:1px solid windowtext;
     mso-diagonal-down:none;
     mso-diagonal-up:none;
     mso-protection:locked visible;
     }
    .x65
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#0563C1;
     font-size:11pt;
     font-weight:400;
     font-style:normal;
     text-decoration:underline;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x66
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:7pt;
     font-weight:400;
     font-style:normal;
     text-decoration:underline;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }
    .x67
     {
     mso-number-format:General;
     text-align:center;
     vertical-align:middle;
     white-space:nowrap;
     background:auto;
     mso-pattern:auto;
     color:#000000;
     font-size:11pt;
     font-weight:700;
     font-style:normal;
     font-family:Calibri,sans-serif;
     mso-protection:locked visible;
     }

</style>
<div class="card" style="border-radius: 0">
    <div class="card-header">
        <h4 class="m-0">Création ordonnance</h4>
    </div>
    <div class="card-body ml-2 mr-2">
        <div class="row">
            <div class="col-md-4">
                <label class="label form-label">Medicament : </label>
                @if (medicaments != null)
                {
                    <RadzenDropDownDataGrid Class="form-control" AllowFiltering="true" TValue="Medicament"
                                        Data="@medicaments"
                                        Placeholder="Liste medicament" Change="@(args => Onchange(args))">
                        <Template Context="data">
                            @if (data.Quantite <= data.Stockmin)
                            {
                                @data.Designation
                                @data.Presentation <span class="float-right bg-danger pl-1 pr-1">@data.Quantite</span>
                            }
                            else if (data.Quantite > data.Stockmin)
                            {
                                @data.Designation
                                @data.Presentation <span class="float-right bg-success pl-1 pr-1">@data.Quantite</span>
                            }
                        </Template>
                    </RadzenDropDownDataGrid>
                }
                <label class="label form-label">Quantité : </label>
                <RadzenNumeric @bind-Value="@nombre" Class="form-control" TValue="Decimal"></RadzenNumeric>
                <label class="label form-label mt-1">Commentaires : </label>
                <RadzenTextArea @bind-Value="@prescription" Class="form-control "></RadzenTextArea>
                <hr />
                <div class="row mt-2">
                    <div class="col"><p><b style="line-height:25px">Matin : </b><RadzenTextBox @bind-Value=@matin class="float-end w-100" /></p></div>
                    <div class="col"><p><b style="line-height:25px">Midi :</b> <RadzenTextBox @bind-Value=@midi class="float-end w-100" /></p></div>
                    <div class="col"><p><b style="line-height:25px">Soir :</b> <RadzenTextBox @bind-Value=@soir class="float-end w-100" /></p></div>
                </div>
                <RadzenButton Click="@(()=>AddPrescInListe())" Size="ButtonSize.Small" Text="Ajouter" class="mt-3 mb-2 float-end" />
            </div>
            <div class="col" style="flex: 1; overflow: auto;">
                @*<div class="row">
                <label class="label form-label float-right ">
                <RadzenTextBox @bind-Value="NumOrdo" Placeholder="N° ordonnance" class="float-right" />
                <span class="float-right mr-2" style="line-height: 30px">Numéro ordonnance :</span>
                </label>
                </div>
                <div class="">
                @if (prescDoc != null)
                {
                <RadzenGrid style="height: 215px" @ref="gridPresc" AllowColumnResize="true" AllowPaging="true" PageSize="6" Data="@prescDoc"
                TItem="PrescriptionDoc" PageSizeText="Page" EmptyText="Aucune information" class="mt-0"
                PagerHorizontalAlign="HorizontalAlign.Center">
                <Columns>
                <RadzenGridColumn Width="50px" TItem="PrescriptionDoc" Property="ArticleId" Title="ID" Filterable=false Sortable=false></RadzenGridColumn>
                <RadzenGridColumn TItem="PrescriptionDoc" Property="Article" Title="Article" Filterable=false Sortable=false></RadzenGridColumn>
                <RadzenGridColumn Width="80px" TItem="PrescriptionDoc" Property="Nombre" Title="Quantité" Filterable=false Sortable=false></RadzenGridColumn>
                <RadzenGridColumn TItem="PrescriptionDoc" Property="Prescription" Title="Préscription" Filterable=false Sortable=false></RadzenGridColumn>
                <RadzenGridColumn Width="80px" TItem="PrescriptionDoc" Title="Sortie" Filterable=false Sortable=false>
                <Template Context=data>
                @if (data.Sortie == 0 || data.Sortie == null)
                {
                <span class="p-2 bg-light">Non</span>
                }
                else
                {
                <span class="p-2 bg-info">Oui</span>
                }
                </Template>
                </RadzenGridColumn>
                <RadzenGridColumn Width="40px" TItem="PrescriptionDoc" Property="Prescription" Filterable=false Sortable=false>
                <Template Context=data>
                @if (data.Sortie == 0 || data.Sortie == null)
                {
                <RadzenButton Click="@(()=>DeletePrescInListe(data))" ButtonStyle="ButtonStyle.Danger" Icon="close" Size="ButtonSize.Small" title="Effacer" />
                }
                else
                {
                <RadzenButton Click="@(()=>DeletePrescInListe(data))" ButtonStyle="ButtonStyle.Danger" Icon="close" Size="ButtonSize.Small" title="Effacer" IsBusy />
                }
                </Template>
                </RadzenGridColumn>
                </Columns>
                </RadzenGrid>
                }
                </div>*@
                <table border='0' cellpadding='0' cellspacing='0' width='760' style='border-collapse:collapse;table-layout:fixed;width:auto'>
                    <col width='254' style='mso-width-source:userset;width:190.5pt'>
                    <col width='113' style='mso-width-source:userset;width:84.75pt'>
                    <col width='64' span='2' style='mso-width-source:userset;width:48pt'>
                    <col width='79' style='mso-width-source:userset;width:59.25pt'>
                    <col width='106' style='mso-width-source:userset;width:79.5pt'>
                    <col width='80' style='width:60pt'>
                    <tr height='15' style='mso-height-source:userset;height:11.45pt'>
                        <td colspan='2' height='15' width='367' style='mso-ignore:colspan;text-align: left;height:11.45pt;vertical-align:top;' align='left'><span style='mso-ignore:vglayout;position:absolute;z-index:0;margin-left:2px;margin-top:0px;width:51px;height:74px'><img width='51' height='74' src="data:image/png;base64,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" name='Image 6' alt='logo hd 2'></span><span style='mso-ignore:vglayout;position:absolute;z-index:0;margin-left:52px;margin-top:2px;width:572px;height:28px'><img width='572' height='28' src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAj4AAAAeCAYAAAAsARSzAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAABGJJREFUeJzt2zFu2zAUgGGq8DF6iiCDt5wiS87Sg+QIXTtl8w0KX8J7EHjMoA6FUJYh+R6fSIq2/g/IEst8TyIfTVPy9PLy8utyuTw4AACAO3W9Xj/O5/PPw+VyeXh8fPx+PB63zgkAAKCJ0+n0eT6fnw7OOXc8Ht3z8/PWOQEAADQxz/P76+ur+7Z1IgAAAL2w8AEAALvBwgcAAOwGCx8AALAbLHyQNE2Tm6bp7mL1Vvvc7vla7dmo/TpiXiPmhNtx2DqBvYkV6zzPG2QC5772B33x13JdRrkeuQ+5UXJEmrRIoQ/REwufTvzC94vc/+YyWvG3yid2vluce5jH0he1c0m1Z+330cZJqOV4rtXmiDU3Ui61hXNe+D+gJ251dRYWO8W/jdTii/4AgPvGjk8H0jeceZ7/223wj4+9V9r2l26nxdqP5aeJnXqPFDuVh9ReLsfcuVjVuJbSdYztPGljpnIovY6S0jETy1PKQ3MeLXMsrTvrWKwZsySvXBup43PHtrxNbGlb8xiBdu7UzCeWuaG0b9EGOz4DWxZCqWIKXwsLzH89VqRh+9J9+FjbqQ+RVLslOyxhe7kcS88ljKGJX/Napq5DSUwph9R5aNvTxMhN3tLYTeWROo8eOabitxiL0nlK9abJS9NGrr1c7rm4a1ja1tSNNHeG7eXir5kbrOeIelj4DMwy8Zd8YMQKv7T4ShYyJVK3ovzXcnmkjosdv+y2xY7peS1LY+ZyWFh2TrQxShdl2jykxbD/VzPHVPzSa2gZs5bcrH2rWWjljq09prQ5SPVcMx8pvnVu8NupNWegHAsfFLuX4kx9C8O4/G/YLT54R1RjXDK2gX94xucOtZrk/K1v7bMktyA8r60XQy1ijtIvo+Rh0Tt3Tb1JeWnbsBitL3vnM9r5Q4+Fz41ZJrLUcwuah+jWxvfb9BcKrWO3JD0/Ef6vlVYxR9kdGSUPiy1yz9WbNi9NG2tyG4H24eHc3Fk7HsbFwqcDv+DW3jNveX+9hPSQJIB6atTb3mt2lLkT2+MZn85Suwpa/rc3zYOeNSe60rbWxJZ+lbFWeM00bd/ibS/pVym9jJKHRWnutcasdG00eVke6pbe37Iva9W9lLdm7ixR6zqzKOuDHZ9OwqKLvaaRe7Zm2VHyY9T8lhdrK/xlgiZ27LhcvPDXFDVo2m55LVPtt4jZ8jpq4i2xauSR+0CrkaP2+Nx7wj5b8ys9aa6Q8tK0kWtPW8NSuyUsbWvy1syd1hxL67R3TeJ/LHw60wzutQUgPQOQm7Cl47TPE9SIZYmnfZ/1GEve0gfN2pgtxtTa/rH0i/W1WrlYx1rpsSV51ujb3n1f2r7lGEvdaKzpm5bjCXVxqwsAAOwGOz43JrZF6r8GAPiKuRMLFj43iCIFxkNdjo8+gnPc6gIAADvCwgcAAOwGCx8AALAbLHwAAMBuHK7X68fpdPqc5/l962QAAABaeHt7uzrn3OSc++Gce9o2HQAAgOZ+/wFiJuhPApAcQAAAAABJRU5ErkJggg==" name='Zone de texte 8'></span><span style='mso-ignore:vglayout2'><table cellpadding='0' cellspacing='0'><tr><td colspan='2' height='15' class='x23' width='367' style='mso-ignore:colspan;height:11.45pt;'><a name="Print_Area"><span style='font-size:12pt;color:#000000;font-weight:400;text-decoration:none;text-line-through:none;font-family:Algerian;'><span style='mso-spacerun:yes;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OSIET<span style='mso-spacerun:yes;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></a></td></tr></table></span></td>
                        <td colspan='3' width='207' style='mso-ignore:colspan;'></td>
                        <td height='15' width='106' style='text-align: left;height:11.45pt;width:79.5pt;vertical-align:top;' align='left'><span style='mso-ignore:vglayout;position:absolute;z-index:0;margin-left:51px;margin-top:0px;width:55px;height:74px'><img width='55' height='74' src="data:image/png;base64,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" name='Image 11' alt='logo hd 2'></span><span style='mso-ignore:vglayout2'><table cellpadding='0' cellspacing='0'><tr><td height='15' width='106' style='height:11.45pt;width:79.5pt;'></td></tr></table></span></td>
                        <td width='80' style='width:60pt;'></td>
                    </tr>
                    <tr height='15' style='mso-height-source:userset;height:11.45pt'>
                        <td colspan='7' height='15' class='x23' style='mso-ignore:colspan;height:11.45pt;'></td>
                    </tr>
                    <tr height='38' style='mso-height-source:userset;height:28.5pt'>
                        <td colspan='6' height='38' class='x58' style='height:28.5pt;'>OSIET</td>
                        <td></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td colspan='6' height='20' class='x60' style='height:15pt;'>ORDONNANCE</td>
                        <td></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td height='20' class='x22' style='height:15pt;'>DATE :</td>
                        <td colspan='2' style='mso-ignore:colspan;'></td>
                        @*<td colspan='1' style='mso-ignore:colspan;'></td>*@
                        <td class='x22' style="">NUMERO :&nbsp;</td>
                        <td colspan='2' class='x55' style='mso-ignore:colspan;'><RadzenTextBox @bind-Value="NumOrdo" Placeholder="N° ordonnance" class="w-100" /></td>
                    </tr>
                    <tr height='22' style='mso-height-source:userset;height:16.5pt'>
                        <td colspan='6' height='20' class='x59' style='border-bottom:2px solid #000000;height:15pt;'>A PROPOS DU PATIENT</td>
                        <td></td>
                    </tr>
                    <tr height='32' style='mso-height-source:userset;height:24pt'>
                        <td height='28' class='x24' style='height:21pt;'>NOM ET PRENOM</td>
                        <td class='x25'>ETAB</td>
                        <td class='x25'>AGE</td>
                        <td class='x25'>CAR</td>
                        <td class='x26'>NUM OSIET</td>
                        <td class='x43'>HEURE ENREGISTREMENT</td>
                        <td></td>
                    </tr>
                    <tr height='21' style='mso-height-source:userset;height:15.75pt'>
                        <td height='19' class='x27' style='height:14.25pt;'></td>
                        <td class='x28'></td>
                        <td class='x28'></td>
                        <td class='x28'></td>
                        <td class='x28'></td>
                        <td class='x28'></td>
                        <td></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td colspan='7' height='20' class='x22' style='mso-ignore:colspan;height:15pt;'></td>
                    </tr>
                    <tr height='22' style='mso-height-source:userset;height:16.5pt'>
                        <td colspan='6' height='22' class='x61' style='height:16.5pt;'>MEDICAMENTS PRESCRITS</td>
                        <td></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td rowspan='2' height='38' class='x56' style='border-bottom:1px solid windowtext;height:28.5pt;'>FANAFODY</td>
                        <td rowspan='2' height='38' class='x56' style='border-bottom:1px solid windowtext;height:28.5pt;'>ISANY</td>
                        <td colspan='3' class='x62' style='border-right:2px solid windowtext;border-bottom:1px solid windowtext;'>FOMBA FIHINANANA ANAZY</td>
                        <td rowspan='2' height='38' class='x56' style='border-bottom:1px solid windowtext;height:28.5pt;'>FANAMARIHANA</td>
                        <td></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td class='x41'>MARAINA</td>
                        <td class='x36'>ATOANDRO</td>
                        <td class='x42'>HARIVA</td>
                        <td></td>
                    </tr>
                    <tr height='28' style='mso-height-source:userset;height:21pt'>
                        <td height='26' class='x39' style='height:19.5pt;'></td>
                        <td class='x46'></td>
                        <td class='x41'></td>
                        <td class='x36'></td>
                        <td class='x42'></td>
                        <td class='x45'></td>
                        <td></td>
                    </tr>
                    <tr height='33' style='mso-height-source:userset;height:24.75pt'>
                        <td height='33' class='x22' style='height:24.75pt;'></td>
                        <td class='x29'>REPOS MEDICAL</td>
                        <td class='x54'>NB DE JOURS&nbsp;</td>
                        <td colspan='4' style='mso-ignore:colspan;'></td>
                    </tr>
                    <tr height='21' style='mso-height-source:userset;height:15.75pt'>
                        <td height='21' style='height:15.75pt;'></td>
                        <td class='x30'></td>
                        <td class='x30'></td>
                        <td colspan='4' style='mso-ignore:colspan;'></td>
                    </tr>
@*                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td height='20' class='x22' style='height:15pt;'><span style='mso-spacerun:yes;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LE MEDECIN TRAITANT</td>
                        <td colspan='6' class='x22' style='mso-ignore:colspan;'></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td colspan='7' height='20' style='mso-ignore:colspan;height:15pt;'></td>
                    </tr>*@
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td colspan='6' height='20' class='x67' style='height:15pt;'>___________________________________________</td>
                        <td class='x34'></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td colspan='6' height='20' class='x66' style='height:15pt;'><font class="font7" style="text-decoration:  underline;">Convention de soins</font><font class="font8" style="text-decoration: none;">&nbsp;: N°0504 MINFOP PTLS/DGTLS/DOLS/SPRIS du 20/03/2000</font></td>
                        <td class='x33'></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td colspan='6' height='20' class='x65' style='height:15pt;'><a href="mailto:osiet.osiet@gmail.com" target="_parent"><span style='font-size:11pt;color:#0563C1;font-weight:400;text-decoration: underline;text-line-through:none;text-underline-style:single;font-family:Calibri;'>E-mail osiet.osiet@gmail.com Tel 034 80 775 43</span></a></td>
                        <td class='x32'></td>
                    </tr>
                    <tr height='20' style='mso-height-source:userset;height:15pt'>
                        <td height='20' class='x31' style='height:15pt;'></td>
                        <td colspan='6' style='mso-ignore:colspan;'></td>
                    </tr>
                    <![if supportMisalignedColumns]>
                    <tr height='0' style='display:none'>
                        <td width='254' style='width:190.5pt;'></td>
                        <td width='113' style='width:84.75pt;'></td>
                        <td width='128' colspan='2' style='width:96pt;mso-ignore:colspan;'></td>
                        <td width='79' style='width:59.25pt;'></td>
                        <td width='106' style='width:79.5pt;'></td>
                        <td width='80' style='width:60pt;'></td>
                    </tr>
                    <![endif]>
                </table>
            </div>
        </div>
    </div>
    <div class="card-footer">
        <RadzenButton Click="@SavePrescription" ButtonStyle="ButtonStyle.Secondary" class="float-end" Text="Enregistrer" />
        <RadzenButton Click="@GoBack" ButtonStyle="ButtonStyle.Warning" class="float-start" Text="Retour en arriere" />
    </div>
</div>
<BlazoredToasts Position="ToastPosition.TopRight" Timeout="5" />
@code {
    [Parameter]
    public string idFichiste { get; set; } = null!;
    RadzenGrid<PrescriptionDoc>? gridPresc;
    Ordonnance ordonnance = new();
    List<OrdonnanceAvoir> avoirOrdonnances = new List<OrdonnanceAvoir>();
    Medicament medicament = new();
    Consultation consultation = new();
    List<Medicament> medicaments = new List<Medicament>();
    List<PrescriptionDoc> prescDoc = new List<PrescriptionDoc>();
    private ToastParameters? _toastParameters;

    string article = null!, prescription = null!, NumOrdo = null!;
    Decimal nombre;
    string? idArticle, matin, midi, soir;

    protected async Task Onchange(Object medic)
    {
        Medicament meds = new();
        meds = (Medicament)medic;
        nombre = new();
        long med = meds.Medicamentid;
        Medicament m = new();
        m = await pharmacieService.GetMedicamentById(med);
        idArticle = "" + m.Medicamentid;
        article = m.Designation + " " + m.Presentation;
    }

    protected async override void OnInitialized()
    {
        await GetAllMedicament();
        await CompletePrescList();
        if (gridPresc != null)
        {
            await gridPresc.Reload();
        }
        if (ordonnance != null) NumOrdo = ordonnance.Numordonnance;
        StateHasChanged();
    }

    public async Task CompletePrescList()
    {
        ordonnance = await ordonnanceService.GetOrdonnancesByFichisteId(Convert.ToInt64(idFichiste));
        if (ordonnance != null)
        {
            avoirOrdonnances = await ordonnanceService.GetAvoirOrdonnancesByOrdonnanceId(ordonnance.Ordonnanceid);
            foreach (var item in avoirOrdonnances)
            {
                Medicament m = await pharmacieService.GetMedicamentById(item.Medicamentid);
                if (m != null)
                {
                    PrescriptionDoc pDoc = new();
                    pDoc.AvoirId = item.Ordonnanceavoirid;
                    pDoc.ArticleId = item.Medicamentid;
                    pDoc.Nombre = item.Quantite;
                    pDoc.Prescription = item.Prescription;
                    pDoc.Article = m.Designation + " " + m.Presentation;
                    pDoc.Sortie = item.Sortie;
                    prescDoc.Add(pDoc);
                }
            }
        }
    }

    public async Task SavePrescription()
    {
        if (ordonnance != null && ordonnance.Ordonnanceid > 0)
        {
            foreach (var data in prescDoc)
            {
                if (data.Sortie == 0 || data.Sortie == null)
                {
                    OrdonnanceAvoir OA = new();
                    OA.Medicamentid = data.ArticleId;
                    OA.Ordonnanceid = ordonnance.Ordonnanceid;
                    OA.Prescription = data.Prescription;
                    OA.Quantite = data.Nombre;
                    OA.Sortie = 0;
                    await ordonnanceService.CreateAvoirOrdonnance(OA);
                }
            }
            _toastParameters = new ToastParameters();
            _toastParameters.Add(nameof(MyToast.Title), "Reussi !");
            _toastParameters.Add(nameof(MyToast.Level), "Success");
            _toastParameters.Add(nameof(MyToast.Message), "Enregistrement terminer.");
            toastService.ShowToast<MyToast>(_toastParameters);

        }
        else
        {
            Ordonnance O = new();
            O.Fichistteid = Convert.ToInt64(idFichiste);
            O.Date = DateTime.Now;
            O.Numordonnance = NumOrdo;
            await ordonnanceService.CreateOrdonnance(O);
            foreach (var data in prescDoc)
            {
                ordonnance = await ordonnanceService.GetOrdonnancesByFichisteId(Convert.ToInt64(idFichiste));

                OrdonnanceAvoir OA = new();
                OA.Medicamentid = data.ArticleId;
                OA.Ordonnanceid = ordonnance.Ordonnanceid;
                OA.Prescription = data.Prescription;
                OA.Quantite = data.Nombre;
                OA.Sortie = 0;
                await ordonnanceService.CreateAvoirOrdonnance(OA);
            }
            _toastParameters = new ToastParameters();
            _toastParameters.Add(nameof(MyToast.Title), "Reussi !");
            _toastParameters.Add(nameof(MyToast.Level), "Success");
            _toastParameters.Add(nameof(MyToast.Message), "Enregistrement terminer.");
            toastService.ShowToast<MyToast>(_toastParameters);
        }
    }

    public async Task GetAllMedicament()
    {
        medicaments = await pharmacieService.GetListMedicament();
    }

    public async Task<decimal> CheckMedicamentQuantityInStock(int idMedicament)
    {
        Medicament medica = new();
        medica = await pharmacieService.GetMedicamentById(idMedicament);
        return medica.Quantite;
    }

    public async Task AddPrescInListe()
    {
        bool exist = false;
        decimal QMedicamentInStock = await CheckMedicamentQuantityInStock(Convert.ToInt32(idArticle));
        decimal QDemande = nombre;
        if (QDemande > QMedicamentInStock)
        {
            _toastParameters = new ToastParameters();
            _toastParameters.Add(nameof(MyToast.Title), "Stock insuffisant!");
            _toastParameters.Add(nameof(MyToast.Level), "Warning");
            _toastParameters.Add(nameof(MyToast.Message), "Nombre de l’Article au pharmacie est insuffisant.");
            toastService.ShowToast<MyToast>(_toastParameters);
        }
        else
        {
            if (idArticle != null && nombre > 0)
            {
                //foreach (var item in prescDoc)
                //{
                //    if (item.ArticleId == Convert.ToInt64(idArticle))
                //    {
                //        _toastParameters = new ToastParameters();
                //        _toastParameters.Add(nameof(MyToast.Title), "Article deja sur la liste !");
                //        _toastParameters.Add(nameof(MyToast.Level), "Warning");
                //        _toastParameters.Add(nameof(MyToast.Message), "Veuillez le supprimer pour pouvoir le modifier.");
                //        toastService.ShowToast<MyToast>(_toastParameters);
                //        exist = true;
                //        break;
                //    }
                //}
                if (exist == false)
                {
                    PrescriptionDoc presc = new();
                    presc.ArticleId = Convert.ToInt64(idArticle);
                    presc.Article = article;
                    presc.Nombre = nombre;
                    presc.Prescription = prescription;
                    prescDoc.Add(presc);
                }

                await gridPresc.Reload();
                StateHasChanged();
            }
            else
            {
                _toastParameters = new ToastParameters();
                _toastParameters.Add(nameof(MyToast.Title), "Attention !");
                _toastParameters.Add(nameof(MyToast.Level), "Error");
                _toastParameters.Add(nameof(MyToast.Message), "Veuillez verifier le nombre ou l'article.");
                toastService.ShowToast<MyToast>(_toastParameters);
                await gridPresc.Reload();
                StateHasChanged();
            }
        }

    }

    public async void DeletePrescInListe(PrescriptionDoc data)
    {
        if (data.AvoirId > 0)
        {
            await ordonnanceService.DeleteAvoirOrdonnance(data.AvoirId);
            prescDoc.Remove(data);
            _toastParameters = new ToastParameters();
            _toastParameters.Add(nameof(MyToast.Title), "Reussi !");
            _toastParameters.Add(nameof(MyToast.Level), "Success");
            _toastParameters.Add(nameof(MyToast.Message), "Effacer terminer.");
            toastService.ShowToast<MyToast>(_toastParameters);
        }
        else
        {
            prescDoc.Remove(data);
            _toastParameters = new ToastParameters();
            _toastParameters.Add(nameof(MyToast.Title), "Reussi !");
            _toastParameters.Add(nameof(MyToast.Level), "Success");
            _toastParameters.Add(nameof(MyToast.Message), "Effacer terminer.");
            toastService.ShowToast<MyToast>(_toastParameters);
        }

        await gridPresc.Reload();
        StateHasChanged();
    }

    protected async void GoBack()
    {
        consultation = await medecinService.GetConsultationByFichisteId(Convert.ToInt64(idFichiste));
        Go.NavigateTo("docteurPatiant/" + consultation.Consultationid);
    }
}
